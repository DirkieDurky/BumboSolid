@model BumboSolid.Data.Models.User

@{
    ViewData["Title"] = "Medewerker Details";
}

<h2>Mijn Bumbo Account</h2>

<div class="mt-3 mb-4">
    <a asp-controller="Home" asp-action="Index" class="btn btn-secondary me-2">Terug</a>
    <a asp-controller="Account" asp-action="Logout" class="btn btn-danger">Uitloggen</a>
</div>

@if (TempData["SuccessMessage"] != null)
{
    <div class="alert alert-success">
        @TempData["SuccessMessage"]
    </div>
}

@if (ViewData.ModelState.ErrorCount > 0)
{
    <div class="alert alert-danger">
        @foreach (var error in ViewData.ModelState.Values.SelectMany(v => v.Errors))
        {
            <p>@error.ErrorMessage</p>
        }
    </div>
}

<div class="card">
    <div class="card-body">
        <h4 class="card-title">@Model.Name</h4>
        <dl class="row">
            <dt class="col-sm-3">Email</dt>
            <dd class="col-sm-9">@Model.Email</dd>

            <dt class="col-sm-3">Woonplaats</dt>
            <dd class="col-sm-9">@Model.PlaceOfResidence</dd>

            <dt class="col-sm-3">Straatnaam</dt>
            <dd class="col-sm-9">@Model.StreetName</dd>

            <dt class="col-sm-3">Huisnummer</dt>
            <dd class="col-sm-9">@Model.StreetNumber</dd>

            <dt class="col-sm-3">Geboortedatum</dt>
            <dd class="col-sm-9">@Model.BirthDate.ToShortDateString()</dd>

            <dt class="col-sm-3">In dienst sinds</dt>
            <dd class="col-sm-9">@Model.EmployedSince.ToShortDateString()</dd>
        </dl>
    </div>
</div>

<hr />

@{
    if (!User.IsInRole("Manager"))
    {
        <h3>Wachtwoord wijzigen</h3>

        <form asp-controller="Account" asp-action="ChangePassword" method="post" class="mt-4">
            <div class="mb-3">
                <label for="CurrentPassword" class="form-label">Huidig wachtwoord</label>
                <div class="input-group">
                    <input type="password" name="CurrentPassword" class="form-control" id="CurrentPassword" required />
                    <button type="button" id="toggleCurrentPassword" class="btn btn-outline-secondary">
                        <i class="fa fa-eye"></i>
                    </button>
                </div>
            </div>

            <div class="mb-3">
                <label for="NewPassword" class="form-label">Nieuw wachtwoord</label>
                <div class="input-group">
                    <input type="password" name="NewPassword" class="form-control" id="NewPassword" required />
                    <button type="button" id="toggleNewPassword" class="btn btn-outline-secondary">
                        <i class="fa fa-eye"></i>
                    </button>
                </div>
            </div>

            <div class="mb-3">
                <label for="ConfirmPassword" class="form-label">Bevestig nieuw wachtwoord</label>
                <div class="input-group">
                    <input type="password" name="ConfirmPassword" class="form-control" id="ConfirmPassword" required />
                    <button type="button" id="toggleConfirmPassword" class="btn btn-outline-secondary">
                        <i class="fa fa-eye"></i>
                    </button>
                </div>
            </div>

            <button type="submit" class="btn btn-primary">Wachtwoord wijzigen</button>
        </form>
    }
}

@section Scripts {
    <script>
        // Toggle visibility for Current Password
        document.getElementById("toggleCurrentPassword").addEventListener("click", function() {
            var passwordField = document.getElementById("CurrentPassword");
            var icon = this.querySelector("i");
            if (passwordField.type === "password") {
                passwordField.type = "text";
                icon.classList.remove("fa-eye");
                icon.classList.add("fa-eye-slash");
            } else {
                passwordField.type = "password";
                icon.classList.remove("fa-eye-slash");
                icon.classList.add("fa-eye");
            }
        });

        // Toggle visibility for New Password
        document.getElementById("toggleNewPassword").addEventListener("click", function() {
            var passwordField = document.getElementById("NewPassword");
            var icon = this.querySelector("i");
            if (passwordField.type === "password") {
                passwordField.type = "text";
                icon.classList.remove("fa-eye");
                icon.classList.add("fa-eye-slash");
            } else {
                passwordField.type = "password";
                icon.classList.remove("fa-eye-slash");
                icon.classList.add("fa-eye");
            }
        });

        // Toggle visibility for Confirm Password
        document.getElementById("toggleConfirmPassword").addEventListener("click", function() {
            var confirmPasswordField = document.getElementById("ConfirmPassword");
            var icon = this.querySelector("i");
            if (confirmPasswordField.type === "password") {
                confirmPasswordField.type = "text";
                icon.classList.remove("fa-eye");
                icon.classList.add("fa-eye-slash");
            } else {
                confirmPasswordField.type = "password";
                icon.classList.remove("fa-eye-slash");
                icon.classList.add("fa-eye");
            }
        });
    </script>
}